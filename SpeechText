import speech_recognition as sr
import pyttsx3

r = sr.Recognizer()

#for index, name in enumerate(sr.Microphone.list_microphone_names()):
#    print(f'{index}, {name}')

def Speak(command):
    engine = pyttsx3.init()
    engine.say(command)
    engine.runAndWait()
    
def Listen():
    print("listening") #prints
    audio=r.listen(source)
    text=r.recognize_google(audio)
    return text

try:
    with sr.Microphone() as source:
        Speak("Please give me a moment.")
        r.adjust_for_ambient_noise(source, duration=3)
        Speak("Okay, tell me what you're doing please.")
        text=Listen()
        
        print(text)
        #Speak(text)
        
except Exception as e:
    print(e)
